@using  System.Globalization
@using Services
@inject IJSRuntime JSRuntime
@inject NavigationManager Nav
@inject IStringLocalizer<MainLayout> Localizer
@inject SabatexLocalizer SL 

<MudMenu StartIcon="@Icons.Rounded.Language"
         Color="Color.Inherit"
         Label="@culturePresent"
         Dense="true" OffsetY="true" Direction="Direction.Right"
         EndIcon="@Icons.Filled.KeyboardArrowDown"
         Class="sabatex-button">
    @foreach (var c in SL)
    {
        <MudMenuItem OnClick="@(()=>selectCulture(c.Key))">@c.Value</MudMenuItem>
    }
</MudMenu>
@code
{
    string culturePresent;

    async Task selectCulture(string value)
    {
        if (value == await SL.GetStoredCulture()) return;
        await SL.SetStoredCulture(value);
        Nav.NavigateTo(Nav.Uri, forceLoad: true);
    }
    
    
    protected override async Task OnParametersSetAsync()
    {
        culturePresent = SL.GetCulturePresent(await SL.GetStoredCulture());
        await base.OnParametersSetAsync();
    }

}